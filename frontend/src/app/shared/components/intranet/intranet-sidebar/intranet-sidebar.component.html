<aside
  class="fixed flex flex-col top-0 left-0 bg-white dark:bg-gray-900 dark:border-gray-800 text-gray-900 h-screen transition-all duration-300 ease-in-out z-50 border-r border-gray-200 w-[290px]"
>
  <!-- Contenedor principal con scroll oculto visualmente -->
  <div class="flex flex-col flex-1 overflow-y-auto sidebar-scroll">

    <!-- Header / Logo / Usuario -->
    <div
      class="relative -mx-5 px-5 pt-0 py-4
            bg-gradient-to-r from-[#E8AE20] to-[#3D5480]
            text-white text-center"
    >
      <!-- Logo -->
      <img
        src="images/logo/uta.png"
        alt="Universidad de Tarapacá"
        class="w-full h-auto mb-0 mt-0"
      />

      <!-- Intranet -->
      <h1 class="text-3xl font-extrabold tracking-wide mb-3" style="color: #F3CA51;">
        Intranet
      </h1>

      <!-- Datos usuario -->
      <div class="text-sm space-y-1">
        <p class="font-semibold">María Antonia González Vega</p>
        <p class="opacity-90">maria.gonzalez.vega@alumnos.uta.cl</p>
        <p class="opacity-80 text-xs">Último Acceso 08-11-2025 02:34:16</p>
      </div>
    </div>

    <!-- Menú de navegación -->
    <nav class="mb-6 px-5">
      <div class="flex flex-col gap-4 py-6">

        <!-- ================= ESTUDIANTE ================= -->
        <div>
          <h2 class="mb-4 text-xs uppercase flex leading-[20px] text-gray-400 justify-start">
            Estudiante
          </h2>

          <ul class="flex flex-col gap-1">
            @for (nav of navItems; track $index) {
              <li>
                @if (nav.disabled) {
                  <div class="menu-item group opacity-50 cursor-default w-full">
                    <span class="menu-item-icon-size" [innerHTML]="nav.icon | safeHtml"></span>
                    <span class="menu-item-text">{{ nav.name }}</span>
                  </div>
                }
              </li>
            }
          </ul>
        </div>

        <!-- ================= TUTOR ================= -->
        <div>
          <h2 class="mb-4 text-xs uppercase flex leading-[20px] text-gray-400 justify-start">
            Tutor
          </h2>

          <ul class="flex flex-col gap-1">
            @for (nav of othersItems; track $index; let i = $index) {
              <li>
                @if (nav.subItems) {
                  <!-- Item principal -->
                  <button
                    (click)="toggleSubmenu('others', i)"
                    class="menu-item group cursor-pointer w-full"
                    [ngClass]="{
                      'menu-item-active': openSubmenu === 'others-' + i,
                      'menu-item-inactive': openSubmenu !== 'others-' + i
                    }"
                  >
                    <span
                      class="menu-item-icon-size"
                      [ngClass]="{
                        'menu-item-icon-active': openSubmenu === 'others-' + i,
                        'menu-item-icon-inactive': openSubmenu !== 'others-' + i
                      }"
                      [innerHTML]="nav.icon | safeHtml"
                    ></span>

                    <span class="menu-item-text">{{ nav.name }}</span>

                    <svg
                      [ngClass]="{
                        'rotate-180 text-brand-500': openSubmenu === 'others-' + i
                      }"
                      class="ml-auto w-5 h-5 transition-transform duration-200"
                      viewBox="0 0 20 20"
                      fill="none"
                    >
                      <path
                        d="M4.79175 7.396L10.0001 12.6043L15.2084 7.396"
                        stroke="currentColor"
                        stroke-width="1.5"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      />
                    </svg>
                  </button>

                  <!-- Segundo nivel -->
                  <div
                    [id]="'others-' + i"
                    [ngClass]="{
                      'hidden': openSubmenu !== 'others-' + i,
                      'block': openSubmenu === 'others-' + i
                    }"
                  >
                    <ul class="mt-2 space-y-1 ml-9">

                      @for (subItem of nav.subItems; track $index; let j = $index) {
                        <li>
                          @if (subItem.hasChildren && subItem.children) {
                            <!-- Item con children -->
                            <button
                              (click)="toggleChildMenu('others', i, j)"
                              class="menu-dropdown-item w-full text-left cursor-pointer flex items-center justify-between"
                              [ngClass]="{
                                'menu-dropdown-item-active':
                                  openChildMenu === 'others-' + i + '-' + j,
                                'menu-dropdown-item-inactive':
                                  openChildMenu !== 'others-' + i + '-' + j
                              }"
                            >
                              <span>{{ subItem.name }}</span>

                              <svg
                                class="w-4 h-4 transition-transform duration-200"
                                [ngClass]="{
                                  'rotate-180': openChildMenu === 'others-' + i + '-' + j
                                }"
                                viewBox="0 0 20 20"
                                fill="none"
                              >
                                <path
                                  d="M4.79175 7.396L10.0001 12.6043L15.2084 7.396"
                                  stroke="currentColor"
                                  stroke-width="1.5"
                                  stroke-linecap="round"
                                  stroke-linejoin="round"
                                />
                              </svg>
                            </button>

                            <!-- Tercer nivel animado -->
                            <div
                              class="overflow-hidden transition-all duration-300 ml-4"
                              [id]="'others-' + i + '-' + j"
                              [ngStyle]="{
                                height:
                                  openChildMenu === 'others-' + i + '-' + j
                                    ? (childMenuHeights['others-' + i + '-' + j] || 0) + 'px'
                                    : '0px'
                              }"
                            >
                              <ul class="mt-1 space-y-1">
                                @for (child of subItem.children; track $index) {
                                  <li>
                                    <a
                                      [routerLink]="child.path"
                                      (click)="onSubmenuClick()"
                                      class="menu-dropdown-item text-sm pl-4"
                                      [ngClass]="{
                                        'menu-dropdown-item-active': isActive(child.path),
                                        'menu-dropdown-item-inactive': !isActive(child.path)
                                      }"
                                    >
                                      {{ child.name }}
                                    </a>
                                  </li>
                                }
                              </ul>
                            </div>
                          }
                        </li>
                      }

                    </ul>
                  </div>
                }
              </li>
            }
          </ul>
        </div>

      </div>
    </nav>

  </div>
</aside>
